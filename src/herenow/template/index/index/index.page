{% extends "/base/main.html" %}

{% block doctitle %}
<title>Welcome</title>
{% endblock %}

{% block heading %}
People in the HackSpace now
{% endblock %}

{% block content %}
{{ msg }}

Here are the people:

<table border="0">
<tr>
<td valign="top" width="300">
    {% for person in person_list %}
        {% if (marble.bag.http.environ['REMOTE_ADDR'] == person.ip) or (marble.bag.http.environ['REMOTE_ADDR'] == '127.0.0.1' and person.mac_address == 'None') %}
            <div style="text-align: center; float:left; padding: 20px; height: 300px;">
                <h2 style="text-align: left">This is you!</h2>

                <p style="text-align: left">You can let other people know your name, status and email address. Your email won't be shown but it will be used to fetch your picture from <a href="http://gravatar.com">gravatar</a> if you have a profile.</p>

                {% if person.email %}
                    <img src="{{ grav_image_from_email(person.email)}}" ><br />
                {% else %}
                    <img src="{{ grav_image(person.mac_address)}}" ><br />
                {% endif %}
                <br />
                {{ form.start_with_layout() }}
                {{ form.field(label='Name', name='name', type='text') }}
                {{ form.field(label='Email', name='email', type='text') }}
                {{ form.field(label='Status', name='status', type='text') }}
                {{ form.action_bar(form.submit(name='submit')) }}
                {{ form.end_with_layout() }}
            </div>

        {% endif %}
    {% endfor %}
</td>
<td valign="top">
    {% for person in person_list %}
            <div style="text-align: center; float:left; padding: 20px; height: 300px;" class="member present">
                <span style="visibility: hidden" class="uid">{{ person.uid }}</span>
                {% if person.email %}
                    <img src="{{ grav_image_from_email(person.email)}}" ><br />
                {% else %}
                    <img src="{{ grav_image(person.mac_address)}}" ><br />
                {% endif %}
                <br />
                {% if person.name %}{{ person.name }} <br />{% endif %}
                {% if person.status %}{{ person.status }} {% endif %}
            </div>
    {% endfor %}
</td>
</tr>
<tr>
<td></td>
<td>
    <h2>People you can leave a message for</h2>
    <p>They'll recieve the message the next time we notice they are in HackSpace.</p>
    {% for person in not_here_list %}
            <div style="text-align: center; float:left; padding: 20px; height: 200px;" class="member">
                <span style="visibility: hidden" class="uid">{{ person.uid }}</span>
                {% if person.email %}
                    <img src="{{ grav_image_from_email(person.email, 100)}}" ><br />
                {% else %}
                    <img src="{{ grav_image(person.mac_address, 100)}}" ><br />
                {% endif %}
                <br />
                {% if person.name %}{{ person.name }} <br />{% endif %}
                {% if person.status %}{{ person.status }} {% endif %}
            </div>
    {% endfor %}
</td>
</tr>
</table>

{% endblock %}
